{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\snmed\\\\Desktop\\\\guuru\\\\guuru2\\\\Guuru_main\\\\frontend\\\\src\\\\components\\\\pages\\\\Private\\\\EditData.jsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { VaultContext } from \"../../../context/vaultContext\";\nimport Axios from 'axios';\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableHead from '@mui/material/TableHead';\nimport TableRow from '@mui/material/TableRow';\nimport Button from '@mui/material/Button';\n\nconst EditData = () => {\n  const {\n    id\n  } = useParams();\n  const [user, setUser] = useState([]);\n  const [saldo, setSaldo] = useState('');\n  const {\n    endDate,\n    setEndDate,\n    setTimelock,\n    timelock\n  } = useContext(VaultContext);\n  const [vault, setVault] = useState('');\n  const [final, setFinal] = useState('');\n  var today = new Date();\n\n  function toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return datum / 1000;\n  }\n\n  function traerUser(user) {\n    Axios.get(`/users/api/edit/${id}`).then(res => {\n      setUser(user => res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  useEffect(() => {\n    traerUser();\n  }, []);\n\n  const saveUser = () => {\n    Axios.post(`/users/api/edit/${id}`, {\n      saldo: saldo,\n      userId: user._id\n    }).then(res => {\n      console.log(res);\n      console.log(saldo);\n    }).catch(err => {\n      console.log(err);\n    });\n  }; //traer vaults \n\n\n  const traerVault = async vaultId => {\n    await Axios.get(`/users/api/vaults/${id}/${vaultId}`).then(res => {\n      res.data.vaults.map(vault => {\n        if (vault._id === vaultId) {\n          setVault(vault);\n          console.log(vault);\n          setTimelock(vault.timelock);\n        }\n      });\n    }).then(() => {\n      setFinal(toTimestamp(new Date(new Date().setDate(today.getDate() + timelock))));\n    }).catch(err => {\n      console.log(err);\n    });\n    setTimeout(() => {\n      activateVault();\n    }, 3000);\n  };\n\n  const activateVault = async vault => {\n    await Axios.post(`/users/api/activate/${id}/${vault}`, {\n      userId: user._id,\n      vaultId: vault,\n      endDate: final\n    }).then(res => {\n      console.log(res);\n    }).catch(err => {\n      console.log(err);\n    }); //window.location.reload();\n  };\n\n  console.log('timelock; ' + timelock);\n  console.log('final' + final);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, \"Editar usuario\"), /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }\n  }, \"Nombre del usuario: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user.displayName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }, \"Email: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user === null || user === void 0 ? void 0 : user.email,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }, \"Saldo disponible: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user.saldo,\n    onChange: e => setSaldo(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }\n  }, \"ID del usuario: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: saveUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 7\n    }\n  }, \"Editar datos\"), /*#__PURE__*/React.createElement(TableContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    sx: {\n      minWidth: 650\n    },\n    \"aria-label\": \"simple table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, \"ID\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }, \"Vault\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, \"Timelock\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 15\n    }\n  }, \"Invertido\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 15\n    }\n  }, \"Auto Renovar\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 15\n    }\n  }, \"Estado\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 15\n    }\n  }, \"Actions\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  }, (user === null || user === void 0 ? void 0 : user.vaults) && user.vaults.map((vault, index) => /*#__PURE__*/React.createElement(TableRow, {\n    key: index,\n    sx: {\n      '&:last-child td, &:last-child th': {\n        border: 0\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, vault._id), /*#__PURE__*/React.createElement(TableCell, {\n    component: \"th\",\n    scope: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }, vault.vault), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, vault.timelock), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  }, vault.funds), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }, vault.autoRenew ? 'activado' : 'no activado'), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, vault.activated ? 'activa' : ' no activa'), !vault.activated ? /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 39\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => traerVault(vault === null || vault === void 0 ? void 0 : vault._id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 64\n    }\n  }, \"Aceptar y activar\")) : null, /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/editvault/${id}/${vault._id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 42\n    }\n  }, \"Editar\")))))))));\n};\n\nexport default EditData;","map":{"version":3,"sources":["C:/Users/snmed/Desktop/guuru/guuru2/Guuru_main/frontend/src/components/pages/Private/EditData.jsx"],"names":["React","useState","useEffect","useContext","useParams","Link","VaultContext","Axios","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Button","EditData","id","user","setUser","saldo","setSaldo","endDate","setEndDate","setTimelock","timelock","vault","setVault","final","setFinal","today","Date","toTimestamp","strDate","datum","parse","traerUser","get","then","res","data","catch","err","console","log","saveUser","post","userId","_id","traerVault","vaultId","vaults","map","setDate","getDate","setTimeout","activateVault","displayName","email","e","target","value","minWidth","index","border","funds","autoRenew","activated"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport { VaultContext } from \"../../../context/vaultContext\";\r\nimport Axios from 'axios';\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableContainer from '@mui/material/TableContainer';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\nimport Button from '@mui/material/Button';\r\n\r\nconst EditData = () => {\r\n  const { id } = useParams();\r\n  const [user, setUser] = useState([]);\r\n  const [saldo, setSaldo] = useState('');\r\n  const { endDate, setEndDate, setTimelock, timelock } = useContext(VaultContext);\r\n  const [vault, setVault] = useState('');\r\n  const [final, setFinal] = useState('');\r\n  var today = new Date();\r\n\r\n\r\n  function toTimestamp(strDate){\r\n    var datum = Date.parse(strDate);\r\n    return datum/1000;\r\n }\r\n\r\n  function traerUser (user){\r\n    Axios.get(`/users/api/edit/${id}`)\r\n            .then(res => {\r\n              setUser(user => res.data)\r\n            })\r\n            .catch(err => {\r\n              console.log(err)\r\n            })\r\n  }\r\n  useEffect(() => {\r\n    traerUser();\r\n  }, []);\r\n\r\n\r\n\r\n  const saveUser = () => {\r\n    Axios.post(`/users/api/edit/${id}`, {\r\n      saldo: saldo,\r\n      userId : user._id,\r\n      \r\n    })\r\n      .then(res => {\r\n        console.log(res)\r\n        console.log(saldo)\r\n      }\r\n      ).catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  //traer vaults \r\n  const traerVault = async(vaultId) => {\r\n    await Axios.get(`/users/api/vaults/${id}/${vaultId}`)\r\n    .then((res) => {\r\n      res.data.vaults.map((vault) => {\r\n        if(vault._id === vaultId){\r\n           setVault( vault)\r\n          console.log(vault)\r\n           setTimelock(vault.timelock)\r\n        }\r\n      })\r\n    })\r\n    .then(() => {\r\n      setFinal(toTimestamp(new Date(new Date().setDate(today.getDate() + timelock))))\r\n    })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n    setTimeout(() => {\r\n       activateVault()\r\n    }, 3000)\r\n      \r\n    \r\n }\r\n\r\n  \r\n  \r\n\r\n  const activateVault = async (vault) => {\r\n    \r\n\r\n    await Axios.post(`/users/api/activate/${id}/${vault}`, {\r\n      userId: user._id,\r\n      vaultId: vault,\r\n      endDate: final\r\n      \r\n    })\r\n      .then(res => {\r\n        console.log(res)\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n      //window.location.reload();\r\n  }\r\n\r\n  console.log('timelock; ' + timelock)\r\n  console.log('final' + final)\r\n\r\n  return (\r\n    <>\r\n      <h1>Editar usuario</h1>\r\n      <form>\r\n      <label>Nombre del usuario: </label>\r\n      <input type=\"text\" defaultValue={user.displayName}/>\r\n      <br/>\r\n      <label>Email: </label>\r\n      <input type=\"text\" defaultValue={user?.email}/>\r\n      <br/>\r\n      <label>Saldo disponible: </label>\r\n      <input type=\"text\" defaultValue={user.saldo} onChange={e => setSaldo(e.target.value)}/>\r\n      <br/>\r\n      <label>ID del usuario: </label>\r\n      <input type=\"text\" defaultValue={user._id}/>\r\n      <br/>\r\n      <button onClick={saveUser}>Editar datos</button>\r\n        <TableContainer >\r\n        <Table sx={{ minWidth: 650 }} aria-label=\"simple table\">\r\n          <TableHead>\r\n            <TableRow>\r\n            <TableCell >ID</TableCell>\r\n              <TableCell>Vault</TableCell>\r\n              <TableCell align=\"right\">Timelock</TableCell>\r\n              <TableCell align=\"right\">Invertido</TableCell>\r\n              <TableCell align=\"right\">Auto Renovar</TableCell>\r\n              <TableCell align=\"right\">Estado</TableCell>\r\n              <TableCell align=\"right\">Actions</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {user?.vaults && user.vaults.map((vault, index) => (\r\n              <TableRow\r\n                key={index}\r\n                sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n              >\r\n                <TableCell align=\"right\">{vault._id}</TableCell>\r\n                <TableCell component=\"th\" scope=\"row\">\r\n                  {vault.vault}\r\n                </TableCell>\r\n                <TableCell align=\"right\">{vault.timelock}</TableCell>\r\n                <TableCell align=\"right\">{vault.funds}</TableCell>\r\n                <TableCell align=\"right\">{(vault.autoRenew) ? 'activado' : 'no activado'}</TableCell>\r\n                <TableCell align=\"right\">{(vault.activated) ? 'activa' : ' no activa'}</TableCell>\r\n                {(!vault.activated) ? <TableCell align=\"right\"><Button variant=\"contained\" onClick={() => traerVault(vault?._id)}>Aceptar y activar</Button></TableCell> : null}\r\n                <TableCell align=\"right\"><Link to={`/editvault/${id}/${vault._id}`}>Editar</Link></TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    \r\n      </form>\r\n\r\n    </>\r\n  )\r\n}\r\n\r\nexport default EditData"]},"metadata":{},"sourceType":"module"}