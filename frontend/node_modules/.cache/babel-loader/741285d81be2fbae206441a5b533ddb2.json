{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\snmed\\\\Desktop\\\\guuru\\\\guuru2\\\\Guuru_main\\\\frontend\\\\src\\\\components\\\\pages\\\\Private\\\\EditData.jsx\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, Link } from 'react-router-dom';\nimport { VaultContext } from \"../../../context/vaultContext\";\nimport Axios from 'axios';\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableContainer from '@mui/material/TableContainer';\nimport TableHead from '@mui/material/TableHead';\nimport TableRow from '@mui/material/TableRow';\nimport Button from '@mui/material/Button';\n\nconst EditData = () => {\n  const {\n    id\n  } = useParams();\n  const [user, setUser] = useState([]);\n  const [saldo, setSaldo] = useState();\n  const {\n    endDate,\n    setEndDate,\n    setTimelock,\n    timelock\n  } = useContext(VaultContext);\n  const [vault, setVault] = useState();\n  var today = new Date();\n  var final = new Date(new Date().setDate(today.getDate() + 90));\n  let finalTimestamp = toTimestamp(final);\n  console.log(finalTimestamp);\n\n  function toTimestamp(strDate) {\n    var datum = Date.parse(strDate);\n    return datum / 1000;\n  }\n\n  function traerUser(user) {\n    Axios.get(`/users/api/edit/${id}`).then(res => {\n      setUser(user => res.data);\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  useEffect(() => {\n    traerUser();\n    setEndDate(finalTimestamp);\n  }, []);\n\n  const saveUser = () => {\n    Axios.post(`/users/api/edit/${id}`, {\n      saldo: saldo,\n      userId: user._id\n    }).then(res => {\n      console.log(res);\n      console.log(saldo);\n    }).catch(err => {\n      console.log(err);\n    });\n  }; //traer vaults \n\n\n  const traerVault = async vaultId => {\n    await Axios.get(`/users/api/vaults/${id}/${vaultId}`).then(res => {\n      res.data.vaults.map(vault => {\n        if (vault._id === vaultId) {\n          setVault(vault);\n          console.log(vault);\n          setTimelock(data => vault.timelock);\n          console.log('timelock: ' + timelock);\n        }\n      });\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const activateVault = vault => {\n    Axios.post(`/users/api/activate/${id}/${vault}`, {\n      userId: user._id,\n      vaultId: vault\n    }).then(res => {\n      console.log(res);\n    }).catch(err => {\n      console.log(err);\n    });\n    window.location.reload();\n  };\n\n  console.log(user);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, \"Editar usuario\"), /*#__PURE__*/React.createElement(\"form\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, \"Nombre del usuario: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user.displayName,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, \"Email: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user === null || user === void 0 ? void 0 : user.email,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, \"Saldo disponible: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user.saldo,\n    onChange: e => setSaldo(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }\n  }, \"ID del usuario: \"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    defaultValue: user._id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: saveUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }, \"Editar datos\"), /*#__PURE__*/React.createElement(TableContainer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    sx: {\n      minWidth: 650\n    },\n    \"aria-label\": \"simple table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, \"ID\"), /*#__PURE__*/React.createElement(TableCell, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, \"Vault\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 15\n    }\n  }, \"Timelock\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 15\n    }\n  }, \"Invertido\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }, \"Auto Renovar\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 15\n    }\n  }, \"Estado\"), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }, \"Actions\"))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, (user === null || user === void 0 ? void 0 : user.vaults) && user.vaults.map((vault, index) => /*#__PURE__*/React.createElement(TableRow, {\n    key: index,\n    sx: {\n      '&:last-child td, &:last-child th': {\n        border: 0\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, vault._id), /*#__PURE__*/React.createElement(TableCell, {\n    component: \"th\",\n    scope: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, vault.vault), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, vault.timelock), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, vault.funds), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }, vault.autoRenew ? 'activado' : 'no activado'), /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }, vault.activated ? 'activa' : ' no activa'), !vault.activated ? /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 39\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => traerVault(vault === null || vault === void 0 ? void 0 : vault._id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 64\n    }\n  }, \"Aceptar y activar\")) : null, /*#__PURE__*/React.createElement(TableCell, {\n    align: \"right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: `/editvault/${id}/${vault._id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 42\n    }\n  }, \"Editar\")))))))));\n};\n\nexport default EditData;","map":{"version":3,"sources":["C:/Users/snmed/Desktop/guuru/guuru2/Guuru_main/frontend/src/components/pages/Private/EditData.jsx"],"names":["React","useState","useEffect","useContext","useParams","Link","VaultContext","Axios","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Button","EditData","id","user","setUser","saldo","setSaldo","endDate","setEndDate","setTimelock","timelock","vault","setVault","today","Date","final","setDate","getDate","finalTimestamp","toTimestamp","console","log","strDate","datum","parse","traerUser","get","then","res","data","catch","err","saveUser","post","userId","_id","traerVault","vaultId","vaults","map","activateVault","window","location","reload","displayName","email","e","target","value","minWidth","index","border","funds","autoRenew","activated"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,SAAT,EAAoBC,IAApB,QAAgC,kBAAhC;AACA,SAASC,YAAT,QAA6B,+BAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,OAAOC,cAAP,MAA2B,8BAA3B;AACA,OAAOC,SAAP,MAAsB,yBAAtB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;AAEA,MAAMC,QAAQ,GAAG,MAAM;AACrB,QAAM;AAAEC,IAAAA;AAAF,MAASZ,SAAS,EAAxB;AACA,QAAM,CAACa,IAAD,EAAOC,OAAP,IAAkBjB,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACkB,KAAD,EAAQC,QAAR,IAAoBnB,QAAQ,EAAlC;AACA,QAAM;AAAEoB,IAAAA,OAAF;AAAWC,IAAAA,UAAX;AAAuBC,IAAAA,WAAvB;AAAoCC,IAAAA;AAApC,MAAiDrB,UAAU,CAACG,YAAD,CAAjE;AACA,QAAM,CAACmB,KAAD,EAAQC,QAAR,IAAoBzB,QAAQ,EAAlC;AAEA,MAAI0B,KAAK,GAAG,IAAIC,IAAJ,EAAZ;AACA,MAAIC,KAAK,GAAG,IAAID,IAAJ,CAAS,IAAIA,IAAJ,GAAWE,OAAX,CAAmBH,KAAK,CAACI,OAAN,KAAkB,EAArC,CAAT,CAAZ;AAEA,MAAIC,cAAc,GAAGC,WAAW,CAACJ,KAAD,CAAhC;AACAK,EAAAA,OAAO,CAACC,GAAR,CAAYH,cAAZ;;AAEA,WAASC,WAAT,CAAqBG,OAArB,EAA6B;AAC3B,QAAIC,KAAK,GAAGT,IAAI,CAACU,KAAL,CAAWF,OAAX,CAAZ;AACA,WAAOC,KAAK,GAAC,IAAb;AACF;;AAEA,WAASE,SAAT,CAAoBtB,IAApB,EAAyB;AACvBV,IAAAA,KAAK,CAACiC,GAAN,CAAW,mBAAkBxB,EAAG,EAAhC,EACSyB,IADT,CACcC,GAAG,IAAI;AACXxB,MAAAA,OAAO,CAACD,IAAI,IAAIyB,GAAG,CAACC,IAAb,CAAP;AACD,KAHT,EAISC,KAJT,CAIeC,GAAG,IAAI;AACZX,MAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AACD,KANT;AAOD;;AAED3C,EAAAA,SAAS,CAAC,MAAM;AACdqC,IAAAA,SAAS;AACTjB,IAAAA,UAAU,CAACU,cAAD,CAAV;AACD,GAHQ,EAGN,EAHM,CAAT;;AAKA,QAAMc,QAAQ,GAAG,MAAM;AACrBvC,IAAAA,KAAK,CAACwC,IAAN,CAAY,mBAAkB/B,EAAG,EAAjC,EAAoC;AAClCG,MAAAA,KAAK,EAAEA,KAD2B;AAElC6B,MAAAA,MAAM,EAAG/B,IAAI,CAACgC;AAFoB,KAApC,EAKGR,IALH,CAKQC,GAAG,IAAI;AACXR,MAAAA,OAAO,CAACC,GAAR,CAAYO,GAAZ;AACAR,MAAAA,OAAO,CAACC,GAAR,CAAYhB,KAAZ;AACD,KARH,EASIyB,KATJ,CASUC,GAAG,IAAI;AACbX,MAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AACD,KAXH;AAYD,GAbD,CAjCqB,CAgDrB;;;AACA,QAAMK,UAAU,GAAG,MAAMC,OAAN,IAAkB;AAEnC,UAAM5C,KAAK,CAACiC,GAAN,CAAW,qBAAoBxB,EAAG,IAAGmC,OAAQ,EAA7C,EACLV,IADK,CACCC,GAAD,IAAS;AACbA,MAAAA,GAAG,CAACC,IAAJ,CAASS,MAAT,CAAgBC,GAAhB,CAAqB5B,KAAD,IAAW;AAC7B,YAAGA,KAAK,CAACwB,GAAN,KAAcE,OAAjB,EAAyB;AACvBzB,UAAAA,QAAQ,CAACD,KAAD,CAAR;AACAS,UAAAA,OAAO,CAACC,GAAR,CAAYV,KAAZ;AACAF,UAAAA,WAAW,CAACoB,IAAI,IAAIlB,KAAK,CAACD,QAAf,CAAX;AACAU,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAeX,QAA3B;AACD;AACF,OAPD;AAQD,KAVK,EAWHoB,KAXG,CAWIC,GAAD,IAAS;AACdX,MAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AACD,KAbG,CAAN;AAcD,GAhBD;;AAqBA,QAAMS,aAAa,GAAI7B,KAAD,IAAW;AAE/BlB,IAAAA,KAAK,CAACwC,IAAN,CAAY,uBAAsB/B,EAAG,IAAGS,KAAM,EAA9C,EAAiD;AAE/CuB,MAAAA,MAAM,EAAE/B,IAAI,CAACgC,GAFkC;AAG/CE,MAAAA,OAAO,EAAE1B;AAHsC,KAAjD,EAMGgB,IANH,CAMQC,GAAG,IAAI;AACXR,MAAAA,OAAO,CAACC,GAAR,CAAYO,GAAZ;AACD,KARH,EASGE,KATH,CASSC,GAAG,IAAI;AACZX,MAAAA,OAAO,CAACC,GAAR,CAAYU,GAAZ;AACD,KAXH;AAYEU,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACH,GAfD;;AAiBAvB,EAAAA,OAAO,CAACC,GAAR,CAAYlB,IAAZ;AAEA,sBACE,uDACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADA,eAEA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,YAAY,EAAEA,IAAI,CAACyC,WAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFA,eAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHA,eAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAJA,eAKA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,YAAY,EAAEzC,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAE0C,KAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALA,eAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IANA,eAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAPA,eAQA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,YAAY,EAAE1C,IAAI,CAACE,KAAtC;AAA6C,IAAA,QAAQ,EAAEyC,CAAC,IAAIxC,QAAQ,CAACwC,CAAC,CAACC,MAAF,CAASC,KAAV,CAApE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IARA,eASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATA,eAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAVA,eAWA;AAAO,IAAA,IAAI,EAAC,MAAZ;AAAmB,IAAA,YAAY,EAAE7C,IAAI,CAACgC,GAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXA,eAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAZA,eAaA;AAAQ,IAAA,OAAO,EAAEH,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAbA,eAcE,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA,oBAAC,KAAD;AAAO,IAAA,EAAE,EAAE;AAAEiB,MAAAA,QAAQ,EAAE;AAAZ,KAAX;AAA8B,kBAAW,cAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACA,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADA,eAEE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAFF,eAGE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAHF,eAIE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAJF,eAKE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBALF,eAME,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cANF,eAOE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAPF,CADF,CADF,eAYE,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,CAAA9C,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEmC,MAAN,KAAgBnC,IAAI,CAACmC,MAAL,CAAYC,GAAZ,CAAgB,CAAC5B,KAAD,EAAQuC,KAAR,kBAC/B,oBAAC,QAAD;AACE,IAAA,GAAG,EAAEA,KADP;AAEE,IAAA,EAAE,EAAE;AAAE,0CAAoC;AAAEC,QAAAA,MAAM,EAAE;AAAV;AAAtC,KAFN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAIE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0BxC,KAAK,CAACwB,GAAhC,CAJF,eAKE,oBAAC,SAAD;AAAW,IAAA,SAAS,EAAC,IAArB;AAA0B,IAAA,KAAK,EAAC,KAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGxB,KAAK,CAACA,KADT,CALF,eAQE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0BA,KAAK,CAACD,QAAhC,CARF,eASE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA0BC,KAAK,CAACyC,KAAhC,CATF,eAUE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA2BzC,KAAK,CAAC0C,SAAP,GAAoB,UAApB,GAAiC,aAA3D,CAVF,eAWE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA2B1C,KAAK,CAAC2C,SAAP,GAAoB,QAApB,GAA+B,YAAzD,CAXF,EAYI,CAAC3C,KAAK,CAAC2C,SAAR,gBAAqB,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAyB,oBAAC,MAAD;AAAQ,IAAA,OAAO,EAAC,WAAhB;AAA4B,IAAA,OAAO,EAAE,MAAMlB,UAAU,CAACzB,KAAD,aAACA,KAAD,uBAACA,KAAK,CAAEwB,GAAR,CAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAzB,CAArB,GAA0J,IAZ7J,eAaE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAyB,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAG,cAAajC,EAAG,IAAGS,KAAK,CAACwB,GAAI,EAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAzB,CAbF,CADe,CADnB,CAZF,CADA,CAdF,CAFF,CADF;AAwDD,CAjJD;;AAmJA,eAAelC,QAAf","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport { VaultContext } from \"../../../context/vaultContext\";\r\nimport Axios from 'axios';\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableContainer from '@mui/material/TableContainer';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\nimport Button from '@mui/material/Button';\r\n\r\nconst EditData = () => {\r\n  const { id } = useParams();\r\n  const [user, setUser] = useState([]);\r\n  const [saldo, setSaldo] = useState();\r\n  const { endDate, setEndDate, setTimelock, timelock } = useContext(VaultContext);\r\n  const [vault, setVault] = useState();\r\n\r\n  var today = new Date();\r\n  var final = new Date(new Date().setDate(today.getDate() + 90));\r\n\r\n  let finalTimestamp = toTimestamp(final);\r\n  console.log(finalTimestamp)\r\n\r\n  function toTimestamp(strDate){\r\n    var datum = Date.parse(strDate);\r\n    return datum/1000;\r\n }\r\n\r\n  function traerUser (user){\r\n    Axios.get(`/users/api/edit/${id}`)\r\n            .then(res => {\r\n              setUser(user => res.data)\r\n            })\r\n            .catch(err => {\r\n              console.log(err)\r\n            })\r\n  }\r\n\r\n  useEffect(() => {\r\n    traerUser();\r\n    setEndDate(finalTimestamp)\r\n  }, []);\r\n\r\n  const saveUser = () => {\r\n    Axios.post(`/users/api/edit/${id}`, {\r\n      saldo: saldo,\r\n      userId : user._id,\r\n      \r\n    })\r\n      .then(res => {\r\n        console.log(res)\r\n        console.log(saldo)\r\n      }\r\n      ).catch(err => {\r\n        console.log(err)\r\n      })\r\n  }\r\n\r\n  //traer vaults \r\n  const traerVault = async(vaultId) => {\r\n    \r\n    await Axios.get(`/users/api/vaults/${id}/${vaultId}`)\r\n    .then((res) => {\r\n      res.data.vaults.map((vault) => {\r\n        if(vault._id === vaultId){\r\n          setVault(vault)\r\n          console.log(vault)\r\n          setTimelock(data => vault.timelock)\r\n          console.log('timelock: ' + timelock)\r\n        }\r\n      })\r\n    })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  \r\n  \r\n\r\n  const activateVault = (vault) => {\r\n    \r\n    Axios.post(`/users/api/activate/${id}/${vault}`, {\r\n      \r\n      userId: user._id,\r\n      vaultId: vault,\r\n      \r\n    })\r\n      .then(res => {\r\n        console.log(res)\r\n      })\r\n      .catch(err => {\r\n        console.log(err)\r\n      })\r\n      window.location.reload();\r\n  }\r\n\r\n  console.log(user);\r\n\r\n  return (\r\n    <>\r\n      <h1>Editar usuario</h1>\r\n      <form>\r\n      <label>Nombre del usuario: </label>\r\n      <input type=\"text\" defaultValue={user.displayName}/>\r\n      <br/>\r\n      <label>Email: </label>\r\n      <input type=\"text\" defaultValue={user?.email}/>\r\n      <br/>\r\n      <label>Saldo disponible: </label>\r\n      <input type=\"text\" defaultValue={user.saldo} onChange={e => setSaldo(e.target.value)}/>\r\n      <br/>\r\n      <label>ID del usuario: </label>\r\n      <input type=\"text\" defaultValue={user._id}/>\r\n      <br/>\r\n      <button onClick={saveUser}>Editar datos</button>\r\n        <TableContainer >\r\n        <Table sx={{ minWidth: 650 }} aria-label=\"simple table\">\r\n          <TableHead>\r\n            <TableRow>\r\n            <TableCell >ID</TableCell>\r\n              <TableCell>Vault</TableCell>\r\n              <TableCell align=\"right\">Timelock</TableCell>\r\n              <TableCell align=\"right\">Invertido</TableCell>\r\n              <TableCell align=\"right\">Auto Renovar</TableCell>\r\n              <TableCell align=\"right\">Estado</TableCell>\r\n              <TableCell align=\"right\">Actions</TableCell>\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n            {user?.vaults && user.vaults.map((vault, index) => (\r\n              <TableRow\r\n                key={index}\r\n                sx={{ '&:last-child td, &:last-child th': { border: 0 } }}\r\n              >\r\n                <TableCell align=\"right\">{vault._id}</TableCell>\r\n                <TableCell component=\"th\" scope=\"row\">\r\n                  {vault.vault}\r\n                </TableCell>\r\n                <TableCell align=\"right\">{vault.timelock}</TableCell>\r\n                <TableCell align=\"right\">{vault.funds}</TableCell>\r\n                <TableCell align=\"right\">{(vault.autoRenew) ? 'activado' : 'no activado'}</TableCell>\r\n                <TableCell align=\"right\">{(vault.activated) ? 'activa' : ' no activa'}</TableCell>\r\n                {(!vault.activated) ? <TableCell align=\"right\"><Button variant=\"contained\" onClick={() => traerVault(vault?._id)}>Aceptar y activar</Button></TableCell> : null}\r\n                <TableCell align=\"right\"><Link to={`/editvault/${id}/${vault._id}`}>Editar</Link></TableCell>\r\n              </TableRow>\r\n            ))}\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n    \r\n      </form>\r\n\r\n    </>\r\n  )\r\n}\r\n\r\nexport default EditData"]},"metadata":{},"sourceType":"module"}